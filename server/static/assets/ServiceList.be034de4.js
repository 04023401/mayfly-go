var P=Object.defineProperty,U=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var C=(e,o,s)=>o in e?P(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,v=(e,o)=>{for(var s in o||(o={}))E.call(o,s)&&C(e,s,o[s]);if(y)for(var s of y(o))I.call(o,s)&&C(e,s,o[s]);return e},_=(e,o)=>U(e,$(o));import{s as g}from"./api.c4e433a1.js";import{x as N,a as B,o as L,t as M,s as w,e as n,Q as T,f as G,h as Q,i as l,w as b,G as r,k as u,l as V}from"./vendor.c08e96cf.js";import{n as k}from"./assert.6143fd7f.js";import"./Api.ab367e46.js";import"./index.ef81b75e.js";var A=N({name:"ServiceList",components:{},setup(){const e=B({permissions:{saveProject:"project:save",saveMember:"project:member:add",delMember:"project:member:del",saveEnv:"project:env:add"},query:{pageNum:1,pageSize:10,name:null},total:0,services:[],btnLoading:!1,chooseId:null,chooseData:null,addServiceDialog:{title:"\u65B0\u589E\u670D\u52A1",visible:!1,form:{name:"",remark:""}}});L(()=>{o()});const o=async()=>{let i=await g.services.request(e.query);e.services=i.list,e.total=i.total},s=i=>{e.query.pageNum=i,o()},D=i=>{i?e.addServiceDialog.form=v({},i):e.addServiceDialog.form={},e.addServiceDialog.visible=!0},p=()=>{e.addServiceDialog.visible=!1,e.addServiceDialog.form={}},S=async()=>{const i=e.addServiceDialog.form;k(i.name,"\u670D\u52A1\u540D\u4E0D\u80FD\u4E3A\u7A7A"),k(i.remark,"\u670D\u52A1\u63CF\u8FF0\u4E0D\u80FD\u4E3A\u7A7A"),await g.saveService.request(i),w.success("\u4FDD\u5B58\u6210\u529F"),o(),p()},t=async i=>{await g.syncService.request({id:i.id}),w.success("\u540C\u6B65\u6210\u529F"),i.canSync=-1},m=i=>{!i||(e.chooseId=i.id,e.chooseData=i)};return _(v({},M(e)),{search:o,handlePageChange:s,choose:m,showAddServiceDialog:D,saveService:S,syncService:t,cancelAddService:p})}}),te="";const R={class:"toolbar"},H=u("\u6DFB\u52A0"),J=u("\u7F16\u8F91"),K=u("\u5220\u9664"),O={style:{float:"right"}},W=l("i",null,null,-1),X=u("\u540C\u6B65"),Y={class:"dialog-footer"},Z=u("\u786E \u5B9A"),x=u("\u53D6 \u6D88");function ee(e,o,s,D,p,S){const t=n("el-button"),m=n("el-input"),i=n("el-radio"),d=n("el-table-column"),q=n("el-table"),j=n("el-pagination"),c=n("el-form-item"),z=n("el-form"),F=n("el-dialog"),f=T("auth");return G(),Q("div",null,[l("div",R,[b(l(t,{onClick:e.showAddServiceDialog,type:"primary",icon:"el-icon-plus",size:"mini"},{default:r(()=>[H]),_:1},8,["onClick"]),[[f,e.permissions.saveProject]]),b(l(t,{onClick:o[1]||(o[1]=a=>e.showAddServiceDialog(e.chooseData)),disabled:e.chooseId==null,type:"primary",icon:"el-icon-edit",size:"mini"},{default:r(()=>[J]),_:1},8,["disabled"]),[[f,e.permissions.saveProject]]),b(l(t,{disabled:e.chooseId==null,type:"danger",icon:"el-icon-delete",size:"mini"},{default:r(()=>[K]),_:1},8,["disabled"]),[[f,"role:del"]]),l("div",O,[l(m,{class:"mr2",placeholder:"\u8BF7\u8F93\u5165\u9879\u76EE\u540D\uFF01",size:"small",style:{width:"140px"},modelValue:e.query.name,"onUpdate:modelValue":o[2]||(o[2]=a=>e.query.name=a),onClear:e.search,clearable:""},null,8,["modelValue","onClear"]),l(t,{onClick:e.search,type:"success",icon:"el-icon-search",size:"mini"},null,8,["onClick"])])]),l(q,{data:e.services,onCurrentChange:e.choose,border:"",ref:"table",style:{width:"100%"}},{default:r(()=>[l(d,{label:"\u9009\u62E9",width:"50px"},{default:r(a=>[l(i,{modelValue:e.chooseId,"onUpdate:modelValue":o[3]||(o[3]=h=>e.chooseId=h),label:a.row.id},{default:r(()=>[W]),_:2},1032,["modelValue","label"])]),_:1}),l(d,{prop:"name",label:"\u670D\u52A1\u540D"}),l(d,{prop:"routePath",label:"\u8DEF\u7531\u8DEF\u5F84"}),l(d,{prop:"urls",label:"\u670D\u52A1\u5730\u5740"},{default:r(a=>[u(V(a.row.urls?a.row.urls:"\u6CE8\u518C\u4E2D\u5FC3"),1)]),_:1}),l(d,{prop:"remark",label:"\u63CF\u8FF0","min-width":"80px","show-overflow-tooltip":""}),l(d,{prop:"createTime",label:"\u521B\u5EFA\u65F6\u95F4"},{default:r(a=>[u(V(e.$filters.dateFormat(a.row.createTime)),1)]),_:1}),l(d,{prop:"creator",label:"\u521B\u5EFA\u8005"}),l(d,{label:"\u64CD\u4F5C","min-width":"80px"},{default:r(a=>[l(t,{onClick:h=>e.syncService(a.row),type:"success",icom:"el-icon-tickets",size:"mini",plain:"",disabled:a.row.canSync==-1},{default:r(()=>[X]),_:2},1032,["onClick","disabled"])]),_:1})]),_:1},8,["data","onCurrentChange"]),l(j,{onCurrentChange:e.handlePageChange,style:{"text-align":"center"},background:"",layout:"prev, pager, next, total, jumper",total:e.total,"current-page":e.query.pageNum,"onUpdate:current-page":o[4]||(o[4]=a=>e.query.pageNum=a),"page-size":e.query.pageSize},null,8,["onCurrentChange","total","current-page","page-size"]),l(F,{width:"400px",title:"\u670D\u52A1\u7F16\u8F91","before-close":e.cancelAddService,modelValue:e.addServiceDialog.visible,"onUpdate:modelValue":o[10]||(o[10]=a=>e.addServiceDialog.visible=a)},{footer:r(()=>[l("div",Y,[l(t,{onClick:e.saveService,type:"primary",size:"small"},{default:r(()=>[Z]),_:1},8,["onClick"]),l(t,{onClick:o[9]||(o[9]=a=>e.cancelAddService()),size:"small"},{default:r(()=>[x]),_:1})])]),default:r(()=>[l(z,{model:e.addServiceDialog.form,size:"small","label-width":"85px"},{default:r(()=>[l(c,{label:"\u670D\u52A1\u540D:",required:""},{default:r(()=>[l(m,{disabled:!!e.addServiceDialog.form.id,modelValue:e.addServiceDialog.form.name,"onUpdate:modelValue":o[5]||(o[5]=a=>e.addServiceDialog.form.name=a),"auto-complete":"off"},null,8,["disabled","modelValue"])]),_:1}),l(c,{label:"\u8DEF\u7531\u8DEF\u5F84:",required:""},{default:r(()=>[l(m,{modelValue:e.addServiceDialog.form.routePath,"onUpdate:modelValue":o[6]||(o[6]=a=>e.addServiceDialog.form.routePath=a),"auto-complete":"off"},null,8,["modelValue"])]),_:1}),l(c,{label:"\u63CF\u8FF0:",required:""},{default:r(()=>[l(m,{modelValue:e.addServiceDialog.form.remark,"onUpdate:modelValue":o[7]||(o[7]=a=>e.addServiceDialog.form.remark=a),"auto-complete":"off"},null,8,["modelValue"])]),_:1}),l(c,{label:"\u5730\u5740:"},{default:r(()=>[l(m,{modelValue:e.addServiceDialog.form.urls,"onUpdate:modelValue":o[8]||(o[8]=a=>e.addServiceDialog.form.urls=a),"auto-complete":"off",placeholder:"\u4E0D\u586B\u5219\u6CE8\u518C\u4E2D\u5FC3\u83B7\u53D6"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["before-close","modelValue"])])}A.render=ee;export default A;
