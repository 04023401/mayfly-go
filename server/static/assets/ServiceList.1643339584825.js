var P=Object.defineProperty,U=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var E=(e,o,r)=>o in e?P(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,g=(e,o)=>{for(var r in o||(o={}))N.call(o,r)&&E(e,r,o[r]);if(A)for(var r of A(o))I.call(o,r)&&E(e,r,o[r]);return e},V=(e,o)=>U(e,$(o));import{s as b}from"./api.16433395848256.js";import{n as w}from"./assert.1643339584825.js";import{_ as M}from"./index.1643339584825.js";import{y as L,a as T,o as G,t as R,d as t,V as H,q as p,e as J,f,w as C,G as S,k as u,j as l,h as d,i as k,E as _}from"./vendor.1643339584825.js";import"./Api.1643339584825.js";const K=L({name:"ServiceList",components:{},setup(){const e=T({permissions:{saveProject:"project:save",saveMember:"project:member:add",delMember:"project:member:del",saveEnv:"project:env:add"},query:{pageNum:1,pageSize:10,name:null},total:0,services:[],btnLoading:!1,chooseId:null,chooseData:null,addServiceDialog:{title:"\u65B0\u589E\u670D\u52A1",visible:!1,form:{name:"",remark:""}}});G(()=>{o()});const o=async()=>{let i=await b.services.request(e.query);e.services=i.list,e.total=i.total},r=i=>{e.query.pageNum=i,o()},F=i=>{i?e.addServiceDialog.form=g({},i):e.addServiceDialog.form={},e.addServiceDialog.visible=!0},v=()=>{e.addServiceDialog.visible=!1,e.addServiceDialog.form={}},h=async()=>{const i=e.addServiceDialog.form;w(i.name,"\u670D\u52A1\u540D\u4E0D\u80FD\u4E3A\u7A7A"),w(i.remark,"\u670D\u52A1\u63CF\u8FF0\u4E0D\u80FD\u4E3A\u7A7A"),await b.saveService.request(i),_.success("\u4FDD\u5B58\u6210\u529F"),o(),v()},s=async i=>{await b.syncService.request({id:i.id}),_.success("\u540C\u6B65\u6210\u529F"),i.canSync=-1},m=i=>{!i||(e.chooseId=i.id,e.chooseData=i)};return V(g({},R(e)),{search:o,handlePageChange:r,choose:m,showAddServiceDialog:F,saveService:h,syncService:s,cancelAddService:v})}}),O={class:"toolbar"},Q=d("\u6DFB\u52A0"),W=d("\u7F16\u8F91"),X=d("\u5220\u9664"),Y={style:{float:"right"}},Z=f("i",null,null,-1),x=d("\u540C\u6B65"),ee={class:"dialog-footer"},oe=d("\u786E \u5B9A"),le=d("\u53D6 \u6D88");function ae(e,o,r,F,v,h){const s=t("el-button"),m=t("el-input"),i=t("el-radio"),n=t("el-table-column"),q=t("el-table"),B=t("el-pagination"),c=t("el-form-item"),j=t("el-form"),z=t("el-dialog"),D=H("auth");return p(),J("div",null,[f("div",O,[C((p(),S(s,{onClick:e.showAddServiceDialog,type:"primary",icon:"el-icon-plus",size:"mini"},{default:u(()=>[Q]),_:1},8,["onClick"])),[[D,e.permissions.saveProject]]),C((p(),S(s,{onClick:o[0]||(o[0]=a=>e.showAddServiceDialog(e.chooseData)),disabled:e.chooseId==null,type:"primary",icon:"el-icon-edit",size:"mini"},{default:u(()=>[W]),_:1},8,["disabled"])),[[D,e.permissions.saveProject]]),C((p(),S(s,{disabled:e.chooseId==null,type:"danger",icon:"el-icon-delete",size:"mini"},{default:u(()=>[X]),_:1},8,["disabled"])),[[D,"role:del"]]),f("div",Y,[l(m,{class:"mr2",placeholder:"\u8BF7\u8F93\u5165\u9879\u76EE\u540D\uFF01",size:"small",style:{width:"140px"},modelValue:e.query.name,"onUpdate:modelValue":o[1]||(o[1]=a=>e.query.name=a),onClear:e.search,clearable:""},null,8,["modelValue","onClear"]),l(s,{onClick:e.search,type:"success",icon:"el-icon-search",size:"mini"},null,8,["onClick"])])]),l(q,{data:e.services,onCurrentChange:e.choose,border:"",ref:"table",style:{width:"100%"}},{default:u(()=>[l(n,{label:"\u9009\u62E9",width:"50px"},{default:u(a=>[l(i,{modelValue:e.chooseId,"onUpdate:modelValue":o[2]||(o[2]=y=>e.chooseId=y),label:a.row.id},{default:u(()=>[Z]),_:2},1032,["modelValue","label"])]),_:1}),l(n,{prop:"name",label:"\u670D\u52A1\u540D"}),l(n,{prop:"routePath",label:"\u8DEF\u7531\u8DEF\u5F84"}),l(n,{prop:"urls",label:"\u670D\u52A1\u5730\u5740"},{default:u(a=>[d(k(a.row.urls?a.row.urls:"\u6CE8\u518C\u4E2D\u5FC3"),1)]),_:1}),l(n,{prop:"remark",label:"\u63CF\u8FF0","min-width":"80px","show-overflow-tooltip":""}),l(n,{prop:"createTime",label:"\u521B\u5EFA\u65F6\u95F4"},{default:u(a=>[d(k(e.$filters.dateFormat(a.row.createTime)),1)]),_:1}),l(n,{prop:"creator",label:"\u521B\u5EFA\u8005"}),l(n,{label:"\u64CD\u4F5C","min-width":"80px"},{default:u(a=>[l(s,{onClick:y=>e.syncService(a.row),type:"success",icom:"el-icon-tickets",size:"mini",plain:"",disabled:a.row.canSync==-1},{default:u(()=>[x]),_:2},1032,["onClick","disabled"])]),_:1})]),_:1},8,["data","onCurrentChange"]),l(B,{onCurrentChange:e.handlePageChange,style:{"text-align":"center"},background:"",layout:"prev, pager, next, total, jumper",total:e.total,"current-page":e.query.pageNum,"onUpdate:current-page":o[3]||(o[3]=a=>e.query.pageNum=a),"page-size":e.query.pageSize},null,8,["onCurrentChange","total","current-page","page-size"]),l(z,{width:"400px",title:"\u670D\u52A1\u7F16\u8F91","before-close":e.cancelAddService,modelValue:e.addServiceDialog.visible,"onUpdate:modelValue":o[9]||(o[9]=a=>e.addServiceDialog.visible=a)},{footer:u(()=>[f("div",ee,[l(s,{onClick:e.saveService,type:"primary",size:"small"},{default:u(()=>[oe]),_:1},8,["onClick"]),l(s,{onClick:o[8]||(o[8]=a=>e.cancelAddService()),size:"small"},{default:u(()=>[le]),_:1})])]),default:u(()=>[l(j,{model:e.addServiceDialog.form,size:"small","label-width":"85px"},{default:u(()=>[l(c,{label:"\u670D\u52A1\u540D:",required:""},{default:u(()=>[l(m,{disabled:!!e.addServiceDialog.form.id,modelValue:e.addServiceDialog.form.name,"onUpdate:modelValue":o[4]||(o[4]=a=>e.addServiceDialog.form.name=a),"auto-complete":"off"},null,8,["disabled","modelValue"])]),_:1}),l(c,{label:"\u8DEF\u7531\u8DEF\u5F84:",required:""},{default:u(()=>[l(m,{modelValue:e.addServiceDialog.form.routePath,"onUpdate:modelValue":o[5]||(o[5]=a=>e.addServiceDialog.form.routePath=a),"auto-complete":"off"},null,8,["modelValue"])]),_:1}),l(c,{label:"\u63CF\u8FF0:",required:""},{default:u(()=>[l(m,{modelValue:e.addServiceDialog.form.remark,"onUpdate:modelValue":o[6]||(o[6]=a=>e.addServiceDialog.form.remark=a),"auto-complete":"off"},null,8,["modelValue"])]),_:1}),l(c,{label:"\u5730\u5740:"},{default:u(()=>[l(m,{modelValue:e.addServiceDialog.form.urls,"onUpdate:modelValue":o[7]||(o[7]=a=>e.addServiceDialog.form.urls=a),"auto-complete":"off",placeholder:"\u4E0D\u586B\u5219\u6CE8\u518C\u4E2D\u5FC3\u83B7\u53D6"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["before-close","modelValue"])])}var de=M(K,[["render",ae]]);export{de as default};
