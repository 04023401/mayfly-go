(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-945da412"],{"9cf3":function(e,t,r){"use strict";var i=r("b2a2"),a=r("857c"),n=r("2732"),o=r("9d5c"),s=r("59da");i("search",1,(function(e,t,r){return[function(t){var r=n(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,r):new RegExp(t)[e](String(r))},function(e){var i=r(t,e,this);if(i.done)return i.value;var n=a(e),l=String(this),c=n.lastIndex;o(c,0)||(n.lastIndex=0);var u=s(n,l);return o(n.lastIndex,c)||(n.lastIndex=c),null===u?-1:u.index}]}))},"9d5c":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},b24e:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return E}));var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"toolbar"},[r("div",{staticClass:"fl"},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",plain:""},on:{click:function(t){return e.openFormDialog(!1)}}},[e._v("添加")]),r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini",disabled:null==e.currentId,plain:""},on:{click:function(t){return e.openFormDialog(e.currentData)}}},[e._v("编辑")]),r("el-button",{attrs:{disabled:null==e.currentId,type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.deleteMachine(e.currentId)}}},[e._v("删除")]),r("el-button",{attrs:{type:"success",disabled:null==e.currentId,size:"mini",plain:""},on:{click:function(t){return e.fileManage(e.currentData)}}},[e._v("文件管理")])],1),r("div",{staticStyle:{float:"right"}},[r("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"host",size:"mini",plain:"",clearable:""},on:{clear:e.search},model:{value:e.params.host,callback:function(t){e.$set(e.params,"host",t)},expression:"params.host"}}),r("el-button",{attrs:{type:"success",icon:"el-icon-search",size:"mini"},on:{click:e.search}})],1)]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.data.list,stripe:""},on:{"current-change":e.choose}},[r("el-table-column",{attrs:{label:"选择",width:"55px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-radio",{attrs:{label:t.row.id},model:{value:e.currentId,callback:function(t){e.currentId=t},expression:"currentId"}},[r("i")])]}}])}),r("el-table-column",{attrs:{prop:"name",label:"名称",width:""}}),r("el-table-column",{attrs:{prop:"ip",label:"IP",width:""}}),r("el-table-column",{attrs:{prop:"port",label:"端口",width:""}}),r("el-table-column",{attrs:{prop:"username",label:"用户名"}}),r("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}}),r("el-table-column",{attrs:{prop:"updateTime",label:"更新时间"}}),r("el-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{ref:t.row,attrs:{type:"primary",icom:"el-icon-tickets",size:"mini",plain:""},on:{click:function(r){return e.info(t.row.id)}}},[e._v("info")]),r("el-button",{ref:t.row,attrs:{type:"success",size:"mini",plain:""},on:{click:function(r){return e.serviceManager(t.row)}}},[e._v("服务管理")])]}}])})],1),r("el-pagination",{staticStyle:{"text-align":"center"},attrs:{background:"",layout:"prev, pager, next, total, jumper",total:e.data.total,"current-page":e.params.pageNum,"page-size":e.params.pageSize},on:{"update:currentPage":function(t){return e.$set(e.params,"pageNum",t)},"update:current-page":function(t){return e.$set(e.params,"pageNum",t)}}}),r("el-dialog",{attrs:{title:"基本信息",visible:e.infoDialog.visible,width:"30%"},on:{"update:visible":function(t){return e.$set(e.infoDialog,"visible",t)}}},[r("div",{staticStyle:{"white-space":"pre-line"}},[e._v(e._s(e.infoDialog.info))])]),r("dynamic-form-dialog",{attrs:{visible:e.formDialog.visible,title:e.formDialog.title,formInfo:e.formDialog.formInfo,formData:e.formDialog.formData},on:{"update:visible":function(t){return e.$set(e.formDialog,"visible",t)},"update:formData":function(t){return e.$set(e.formDialog,"formData",t)},"update:form-data":function(t){return e.$set(e.formDialog,"formData",t)},submitSuccess:e.submitSuccess}})],1)},a=[],n=(r("b4fb"),r("053b"),r("e35a"),r("9cf3"),r("6a61"),r("cf7f")),o=r("1462"),s=r("a340"),l=r("bb06"),c=r("9691"),u=r("0372"),f=r("e4a1"),p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"dynamic-form"},[r("el-form",{ref:"dynamicForm",attrs:{model:e.form,"label-width":e.formInfo.labelWidth?e.formInfo.labelWidth:"100px",size:e.formInfo.size?e.formInfo.size:"small"}},[e._l(e.formInfo.formRows,(function(t){return r("el-row",{key:t.key},e._l(t,(function(i){return r("el-col",{key:i.key,attrs:{span:i.span?i.span:24/t.length}},[r("el-form-item",{attrs:{prop:i.name,label:i.label,"label-width":i.labelWidth,required:i.required,rules:i.rules}},["input"===i.type?r("el-input",{attrs:{placeholder:i.placeholder,type:i.inputType,clearable:"",autocomplete:"new-password"},on:{change:function(t){i.change&&i.change(e.form)}},model:{value:e.form[i.name],callback:function(t){e.$set(e.form,i.name,"string"===typeof t?t.trim():t)},expression:"form[item.name]"}}):"text"===i.type?r("span",[e._v(e._s(e.form[i.name]))]):"select"===i.type?r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:i.placeholder,filterable:i.filterable,remote:i.remote,"remote-method":i.remoteMethod,clearable:"",disabled:i.updateDisabled&&null!=e.form.id},on:{focus:function(t){i.focus&&i.focus(e.form)}},model:{value:e.form[i.name],callback:function(t){e.$set(e.form,i.name,"string"===typeof t?t.trim():t)},expression:"form[item.name]"}},e._l(i.options,(function(e){return r("el-option",{key:e.key,attrs:{label:e[i.optionProps&&i.optionProps.label||"label"],value:e[i.optionProps&&i.optionProps.value||"value"]}})})),1):e._e()],1)],1)})),1)})),r("el-row",{attrs:{type:"flex",justify:"center"}},[e._t("btns",[r("el-button",{attrs:{size:"mini"},on:{click:e.reset}},[e._v("重 置")]),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.submit}},[e._v("保 存")])],{submitDisabled:e.submitDisabled,data:e.form,submit:e.submit})],2)],2)],1)},m=[];r("f3dd"),r("dbb3"),r("fe59"),r("b73f"),r("bf84"),r("fe8a"),r("08ba");function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=function(e){Object(l["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(o["a"])(this,r),e=t.apply(this,arguments),e.form={},e.submitDisabled=!1,e}return Object(s["a"])(r,[{key:"onRoleChange",value:function(){this.formData&&(this.form=h({},this.formData))}},{key:"submit",value:function(){var e=this,t=this.$refs["dynamicForm"];t.validate((function(t){if(!t)return!1;var r=h({},e.form),i=e.form["id"]?e.formInfo["updateApi"]:e.formInfo["createApi"];i?(e.submitDisabled=!0,i.request(e.form).then((function(t){e.$message.success("保存成功"),e.$emit("submitSuccess",r),e.submitDisabled=!1}),(function(t){e.submitDisabled=!1}))):e.$message.error("表单未设置对应的提交权限")}))}},{key:"reset",value:function(){this.$emit("reset"),this.resetFieldsAndData()}},{key:"resetFieldsAndData",value:function(){var e=this.$refs["dynamicForm"];e.resetFields(),this.form={}}},{key:"mounted",value:function(){this.form=h({},this.formData)}}]),r}(f["c"]);Object(u["a"])([Object(f["b"])()],v.prototype,"formInfo",void 0),Object(u["a"])([Object(f["b"])()],v.prototype,"formData",void 0),Object(u["a"])([Object(f["d"])("formData",{deep:!0})],v.prototype,"onRoleChange",null),v=Object(u["a"])([Object(f["a"])({name:"DynamicForm"})],v);var g=v,y=g,D=r("9ca4"),O=Object(D["a"])(y,p,m,!1,null,null,null),j=O.exports,w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-dialog"},[r("el-dialog",{attrs:{title:e.title,visible:e.visible,width:e.dialogWidth?e.dialogWidth:"500px"}},[r("dynamic-form",{ref:"df",attrs:{"form-info":e.formInfo,"form-data":e.formData},on:{submitSuccess:e.submitSuccess},scopedSlots:e._u([{key:"btns",fn:function(t){return[e._t("btns",[r("el-button",{attrs:{disabled:t.submitDisabled,type:"primary",size:"mini"},on:{click:t.submit}},[e._v("保 存")]),r("el-button",{attrs:{disabled:t.submitDisabled,size:"mini"},on:{click:function(t){return e.close()}}},[e._v("取 消")])])]}}],null,!0)})],1)],1)},k=[],I=function(e){Object(l["a"])(r,e);var t=Object(c["a"])(r);function r(){return Object(o["a"])(this,r),t.apply(this,arguments)}return Object(s["a"])(r,[{key:"close",value:function(){var e=this;this.$emit("update:visible",!1),this.$emit("update:formData",null),this.$emit("close"),setTimeout((function(){var t=e.$refs.df;t.resetFieldsAndData()}),200)}},{key:"submitSuccess",value:function(e){this.$emit("submitSuccess",e),this.close()}}]),r}(f["c"]);Object(u["a"])([Object(f["b"])()],I.prototype,"visible",void 0),Object(u["a"])([Object(f["b"])()],I.prototype,"dialogWidth",void 0),Object(u["a"])([Object(f["b"])()],I.prototype,"title",void 0),Object(u["a"])([Object(f["b"])()],I.prototype,"formInfo",void 0),Object(u["a"])([Object(f["b"])()],I.prototype,"formData",void 0),I=Object(u["a"])([Object(f["a"])({name:"DynamicFormDialog",components:{DynamicForm:j}})],I);var x=I,_=x,S=Object(D["a"])(_,w,k,!1,null,null,null),$=S.exports,z=r("d789"),F=function(){function e(t,r){Object(o["a"])(this,e),this.url=t,this.method=r}return Object(s["a"])(e,[{key:"setUrl",value:function(e){return this.url=e,this}},{key:"setMethod",value:function(e){return this.method=e,this}},{key:"getUrl",value:function(){return z["a"].getApiUrl(this.url)}},{key:"request",value:function(e){return z["a"].send(this,e)}},{key:"requestWithHeaders",value:function(e,t){return z["a"].sendWithHeaders(this,e,t)}}],[{key:"create",value:function(t,r){return new e(t,r)}}]),e}(),P=F,q={list:P.create("/machines","get"),info:P.create("/machines/{id}/sysinfo","get"),save:P.create("/devops/machines","post"),update:P.create("/devops/machines/{id}","put"),del:P.create("/devops/machines/{id}","delete"),files:P.create("/devops/machines/{id}/files","get"),lsFile:P.create("/devops/machines/files/{fileId}/ls","get"),rmFile:P.create("/devops/machines/files/{fileId}/rm","delete"),uploadFile:P.create("/devops/machines/files/upload","post"),fileContent:P.create("/devops/machines/files/{fileId}/cat","get"),updateFileContent:P.create("/devops/machines/files/{id}","put"),addConf:P.create("/devops/machines/{machineId}/files","post"),delConf:P.create("/devops/machines/files/{id}","delete")},C=function(e){Object(l["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(o["a"])(this,r),e=t.apply(this,arguments),e.data={list:[],total:10},e.infoDialog={visible:!1,info:""},e.currentId=null,e.currentData=null,e.params={pageNum:1,pageSize:10,host:null,clusterId:null},e.dialog={machineId:null,visible:!1,title:""},e.formDialog={visible:!1,title:"",formInfo:{createApi:q.save,updateApi:q.update,formRows:[[{type:"input",label:"名称：",name:"name",placeholder:"请输入名称",rules:[{required:!0,message:"请输入名称",trigger:["blur","change"]}]}],[{type:"input",label:"ip：",name:"ip",placeholder:"请输入ip",rules:[{required:!0,message:"请输入ip",trigger:["blur","change"]}]}],[{type:"input",label:"端口号：",name:"port",placeholder:"请输入端口号",inputType:"number",rules:[{required:!0,message:"请输入ip",trigger:["blur","change"]}]}],[{type:"input",label:"用户名：",name:"username",placeholder:"请输入用户名",rules:[{required:!0,message:"请输入用户名",trigger:["blur","change"]}]}],[{type:"input",label:"密码：",name:"password",placeholder:"请输入密码",inputType:"password"}]]},formData:{port:22}},e}return Object(s["a"])(r,[{key:"mounted",value:function(){this.search()}},{key:"choose",value:function(e){e&&(this.currentId=e.id,this.currentData=e)}},{key:"info",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,q.info.request({id:t});case 2:r=e.sent,this.infoDialog.info=r,this.infoDialog.visible=!0;case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"openFormDialog",value:function(e){var t;e?(this.formDialog.formData=this.currentData,t="编辑机器"):(this.formDialog.formData={port:22},t="添加机器"),this.formDialog.title=t,this.formDialog.visible=!0}},{key:"deleteMachine",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,q.del.request({id:t});case 2:this.$message.success("操作成功"),this.search();case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"fileManage",value:function(e){this.dialog.machineId=e.id,this.dialog.visible=!0,this.dialog.title="".concat(e.name," => ").concat(e.ip)}},{key:"submitSuccess",value:function(){this.currentId=null,this.currentData=null,this.search()}},{key:"search",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,q.list.request(this.params);case 2:t=e.sent,this.data=t;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),r}(f["c"]);C=Object(u["a"])([Object(f["a"])({name:"MachineList",components:{DynamicFormDialog:$}})],C);var R=C,A=R,M=Object(D["a"])(A,i,a,!1,null,null,null),E=M.exports},b4fb:function(e,t,r){"use strict";var i=r("1c8b"),a=r("efe2"),n=r("74e7"),o=r("a719"),s=r("3553"),l=r("d88d"),c=r("1bbd"),u=r("1ca1"),f=r("1ea7"),p=r("90fb"),m=r("f594"),d=p("isConcatSpreadable"),b=9007199254740991,h="Maximum allowed index exceeded",v=m>=51||!a((function(){var e=[];return e[d]=!1,e.concat()[0]!==e})),g=f("concat"),y=function(e){if(!o(e))return!1;var t=e[d];return void 0!==t?!!t:n(e)},D=!v||!g;i({target:"Array",proto:!0,forced:D},{concat:function(e){var t,r,i,a,n,o=s(this),f=u(o,0),p=0;for(t=-1,i=arguments.length;t<i;t++)if(n=-1===t?o:arguments[t],y(n)){if(a=l(n.length),p+a>b)throw TypeError(h);for(r=0;r<a;r++,p++)r in n&&c(f,p,n[r])}else{if(p>=b)throw TypeError(h);c(f,p++,n)}return f.length=p,f}})},b73f:function(e,t,r){var i=r("1c8b"),a=r("efe2"),n=r("da10"),o=r("aa6b").f,s=r("1e2c"),l=a((function(){o(1)})),c=!s||l;i({target:"Object",stat:!0,forced:c,sham:!s},{getOwnPropertyDescriptor:function(e,t){return o(n(e),t)}})},bf84:function(e,t,r){var i=r("1c8b"),a=r("1e2c"),n=r("8d44"),o=r("da10"),s=r("aa6b"),l=r("1bbd");i({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(e){var t,r,i=o(e),a=s.f,c=n(i),u={},f=0;while(c.length>f)r=a(i,t=c[f++]),void 0!==r&&l(u,t,r);return u}})},fe8a:function(e,t,r){var i=r("1c8b"),a=r("3553"),n=r("cbab"),o=r("efe2"),s=o((function(){n(1)}));i({target:"Object",stat:!0,forced:s},{keys:function(e){return n(a(e))}})}}]);